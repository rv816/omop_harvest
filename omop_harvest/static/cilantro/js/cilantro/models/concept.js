define(["underscore","backbone","../core","./base","./field"],function(e,t,i,n,r){var s=n.Model.extend({constructor:function(){this.fields=new r.FieldCollection,n.Model.prototype.constructor.apply(this,arguments)},initialize:function(){n.Model.prototype.initialize.call(this,arguments),i.on(i.CONCEPT_FOCUS,function(e){this.id===e&&0===this.fields.length&&this.fields.fetch({reset:!0})},this)},parse:function(e,t){n.Model.prototype.parse.call(this,e,t);var i=this;return this.fields.url=function(){return i.links.fields},e?(e.fields&&(this.fields.set(e.fields,t),delete e.fields),e):void 0}}),l=n.Collection.extend({model:s,search:function(i,n){return t.ajax({url:e.result(this,"url"),data:{query:i,brief:1},dataType:"json",success:function(e){n(e)}})}}),o=l.extend({constructor:function(){this.queryable=new l,this.viewable=new l;var t=this;this.queryable.url=function(){return e.result(t,"url")},this.viewable.url=function(){return e.result(t,"url")},l.prototype.constructor.apply(this,arguments)},initialize:function(){this.on("add remove reset",function(){this.queryable.reset(this.filter(function(e){return!!e.get("queryable")||!!e.get("queryview")})),this.viewable.reset(this.filter(function(e){return!!e.get("viewable")||!!e.get("formatter_name")}))})}});return{Concept:s,Concepts:o}});
//# sourceMappingURL=concept.js.map